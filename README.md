# EEG-LFP-Emotion-Recognition-CBAM

# 项目名称 🚀
> 基于CBAM的抑郁情绪状态LFP-EEG联合解码方法和系统

## 目录 📑
- [项目简介](#项目简洁)
- [特性](#特性)
- [数据介绍](#数据介绍)
- [模型简介](#模型简介)
- [算法流程](#算法流程)


## 项目简介 📖

本项目提出一种基于卷积块注意力模块（CBAM） 的抑郁情绪状态解码方案，针对患者的局部场电位（LFP） 和脑电图（EEG） 双模态脑电数据，实现正负情绪状态的精准分类。


核心思路：通过离散短时傅里叶变换（DSTFT）提取双模态数据的时频特征，利用 LFP 与 EEG 的模态互补性，结合 CBAM 在「频率 - 时间 - 通道」三维维度上增强关键特征，最终构建轻量级联合解码模型。相比传统单模态或无注意力机制的解码方法，本方案能更精准捕捉患者与情绪相关的脑电活动，提升情绪分类任务的准确率，为抑郁情绪评估提供技术支撑。


## 特性 ✨
-🔥 双模态数据融合：原生支持 LFP 与 EEG 同步输入，充分利用两种脑电信号的模态互补性（LFP 分辨率高、EEG 覆盖范围广）。

-📊 三维特征增强：基于 CBAM 实现「频率 - 时间 - 通道」维度的注意力加权，突出情绪相关的关键脑电特征，抑制噪声干扰。

-⚡ 轻量级模型结构：无复杂冗余模块，模型参数少、推理速度快，适合部署于资源受限的医疗场景（如便携式脑电设备）。

-🎯 抑郁情绪适配：针对患者脑电信号特点优化，聚焦正负情绪分类任务，解码性能优于传统方法（如 LDA、SVM）。


## 数据介绍 📥

研究对象：6 名确诊癫痫患者。

采集场景：患者完成情绪诱发任务 —— 观看预设的「正性情绪图片」（如笑脸、风景）和「负性情绪图片」（如悲伤场景、冲突画面）。

信号参数：同步采集 EEG和 LFP（采样率22K)。

采集时长：每位患者单次任务时长 60-120 分钟，包含多次情绪图片刺激（如每类情绪图片重复呈现 20-30 次）。

## 模型简介 🧠

模型架构

本项目的核心模型基于「DSTFT特征提取 + CBAM 注意力增强 + 分类器」三部分构建，具体流程如下：

1．特征提取层：

·对 LFP 和 EEG 的时域信号分别执行 DSTFT，生成两类时频图（时间步长  频率维度  通道数）；

·将双模态时频图在通道维度拼接，得到初始联合特征（如  ，其中  时间、  频率、  通道）。

2．CBAM 注意力增强层：

通道注意力：对联合特征的通道维度进行全局平均池化和最大池化，通过共享 MLP 学习通道权重，突出对情绪解码关键的通道；

时间－频率注意力：对通道加权后的特征沿通道维度池化，得到 TxF 维度的特征图，通过卷积和 Sigmoid学习时间－频率维度的权重，聚焦情绪相关的时频区域；

最终输出「频率－时间－通道」三维增强后的特征。

3．分类层：

·对增强后的特征执行全局平均池化，得到一维特征向量；

·通过全连接层映射到 2 个类别（正性情绪／负性情绪），使用交叉嫡损失函数训练模型。


4．模型优势

·模态融合高效：直接通过通道拼接和注意力加权实现双模态信息互补；

·特征增强精准：CBAM 的三维注意力机制可针对性强化情绪相关的时频－通道特征；

·轻量化设计：CBAM 模块仅增加少量参数（如通道注意力的 MLP 仅含 2 层）推理速度快。

## 算法流程 📝


<img width="576" height="388" alt="image" src="https://github.com/user-attachments/assets/35c4a799-c7ed-4a50-b0f8-d5724f3cdefb" />


